<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="https://files.codepedia.info/files/uploads/iScripts/html2canvas.js"></script>
<link rel="stylesheet" href="style.css">
</head>
<body>
	
	<h1>Digite um numero.</h1>
	
	
	<input type="number" maxlength="10" name="msg" id="mensagem" >
	
	<div id="html-content-holder">
	</div>
	
	<a href="#janela1" class="btn-Preview-Image btn" rel="modal">Visualizar</a>
	<a id="btn-Convert-Html2Image" class="btn" href="#">Download</a>

	<div class="window" id="janela1">
		<a href="#" class="fechar">X Fechar</a>
		<div id="previewImage"></div>
	</div>
	
	<div id="mascara"></div>

	
		
<br/>

		
<script>

		//Captura de teclas

		var msg = document.getElementById('mensagem')
		var saida = document.getElementById('html-content-holder')

		msg.addEventListener("keypress", 
		
		function (evento){
			exibeImg(evento.keyCode)
		})
		
		msg.addEventListener("keydown", 
		
		function (evento){
			if (evento.keyCode == 8) {
				$('#html-content-holder :last-child').remove();
			}
		})


		function exibeImg(address) {
			switch (address) {
				case 48:

				saida.innerHTML += "<img src='numbers/0.png'> "
			
					break;
				case 49:

				saida.innerHTML += "<img src='numbers/1.png'> "

					break;
				case 50:

				saida.innerHTML += "<img src='numbers/2.png'> "

					break;
				case 51:

				saida.innerHTML += "<img src='numbers/3.png'> "

					break;
				case 52:

				saida.innerHTML += "<img src='numbers/4.png'> "

					break;
				case 53:

				saida.innerHTML += "<img src='numbers/5.png'> "

					break;
				case 54:

				saida.innerHTML += "<img src='numbers/6.png'> "

					break;
				case 55:

				saida.innerHTML += "<img src='numbers/7.png'> "

					break;
				case 56:

				saida.innerHTML += "<img src='numbers/8.png'> "

					break;
				case 57:

				saida.innerHTML += "<img src='numbers/9.png'> "

					break;

				default:

					break;
			}
		}

	
	//Escreve na div em tempo real
	function EscreverImg() {
		var saida = document.querySelector("div#html-content-holder")
		var entrada = document.querySelector("#mensagem").value

		saida.innerHTML = `
		<h3>
        	<strong>Esta Ã© a sua mensagem.</strong><hr/>
		</h3>

		<p id="Saida">
			${entrada}
		</p>
		`
	}


	//configura o modal
	$(document).ready(function(){
    $("a[rel=modal]").click( function(ev){
        ev.preventDefault();
 
        var id = $(this).attr("href");
 
        var alturaTela = $(document).height();
        var larguraTela = $(window).width();
     
        //colocando o fundo preto
        $('#mascara').css({'width':larguraTela,'height':alturaTela});
        $('#mascara').fadeIn(1000); 
        $('#mascara').fadeTo("slow",0.8);
 
        var left = ($(window).width() /2) - ( $(id).width() / 2 );
        var top = ($(window).height() / 2) - ( $(id).height() / 2 );
     
        $(id).css({'top':top,'left':left});
        $(id).show();   
    });
 
    $("#mascara").click( function(){
        $(this).hide();
        $(".window").hide();
    });
 
    $('.fechar').click(function(ev){
        ev.preventDefault();
        $("#mascara").hide();
        $(".window").hide();
    });
	});


	//visualizar e download
	$(document).ready(function(){

	
	var element = $("#html-content-holder");
	var getCanvas

		$(".btn-Preview-Image").on('click', function () {
			html2canvas(element, {
			onrendered: function (canvas) {
					$("#previewImage");
					getCanvas = canvas;
				}
			});
		});

		$("#btn-Convert-Html2Image").on('click', function () {
		var imgageData = getCanvas.toDataURL("image/png");
		var newData = imgageData.replace(/^data:image\/png/, "data:application/octet-stream");
		$("#btn-Convert-Html2Image").attr("download", "Sua_Mensagem.png").attr("href", newData);
		});
	});		

</script>
</body>
</html>